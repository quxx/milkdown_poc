/* Copyright 2021, Milkdown by Mirone. */

import { commands, inputrules, keymap, plugins, schema } from "./composed";
import { Editor, rootCtx } from "@milkdown/core";
import { nord } from "@milkdown/theme-nord";
import { Milkdown, MilkdownProvider, useEditor } from "@milkdown/react";

//export * from './node'
//export * from './mark'
//export * from './plugin'
//export * from './composed'

/// The commonmark preset, includes all the plugins.

interface PepperMilkdownConfig {
  config: PepperMilkdownFunc[];
}

export enum PepperMilkdownFunc {
  Bold,
  Italic,
}

const MilkdownEditor: React.FC<PepperMilkdownConfig> = ({ config }) => {
  useEditor((root) =>
    Editor.make()
      .config(nord)
      .config((ctx) => {
        ctx.set(rootCtx, root);
      })
      .use(peppaPreset)
  );

  return <Milkdown />;
};

export const PeppaMilkdownEditor: React.FC<PepperMilkdownConfig> = ({
  config,
}) => {
  return (
    <MilkdownProvider>
      <MilkdownEditor config={config} />
    </MilkdownProvider>
  );
};

export const peppaPreset = [
  schema,
  inputrules,
  commands,
  keymap,
  plugins,
].flat();
